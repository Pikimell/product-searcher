{"version":3,"file":"commonHelpers.js","sources":["../src/js/render.js","../src/js/product-list.js","../src/js/excel.js","../src/js/loadFile.js","../src/js/saveFile.js","../src/main.js"],"sourcesContent":["function productTemplate(product, i) {\n  const validOrders = parseInt(product.orders) > 500;\n  const validPopularity = parseInt(product.popularity) > 50;\n  const validMedia = product.youtube_media;\n  const isValid = validOrders && validPopularity && validMedia;\n\n  const myClass = isValid ? 'valid' : 'invalid';\n\n  return `\n      <tr class=${myClass}>\n        <td>${i + 1 || ''}</td>\n        <td>${product.product_name || ''}</td>\n        <td>${product.source || ''}</td>\n\n        <td>\n        ${product.link_1 ? `<a href=\"${product.link_1}\">Store-1</a>` : ''}\n        ${product.link_2 ? `<a href=\"${product.link_2}\">Store-2</a>` : ''}\n        ${product.link_3 ? `<a href=\"${product.link_3}\">Store-3</a>` : ''}\n        </td>\n        \n        <td>${\n          product.aliexpress\n            ? `<a href=\"${product.aliexpress}\">ALIEXPRESS</a>`\n            : ''\n        }</td>\n        \n        <td class=\"table-border\"></td>\n        <td>${product.orders || ''}</td>\n        <td>${product.popularity || ''}</td>\n        <td>${product.reviews || ''}</td>\n        <td><input type=\"checkbox\" ${\n          product.youtube_media ? 'checked' : ''\n        }></td>\n        <td class=\"table-border\"></td>\n\n        <td>${\n          product.supplier_link\n            ? `<a href=\"${product.supplier_link}\">Supplier Link</a>`\n            : ''\n        }</td>\n        <td>${product.supplier_price || ''}</td>\n        <td>${product.sale_price || ''}</td>\n        <td>${product.competitor_price || ''}</td>\n        <td>${product.comments || ''}</td>\n        <td>${product.margin || ''}</td>\n        <td>${product.niche || ''}</td>\n        <td>${product.points || ''}</td>\n\n        <td class=\"table-border\"></td>\n\n        <td> <button class=\"btn\" data-type=\"edit\">Edit</button> </td>\n        <td> <button class=\"btn\" data-type=\"delete\">Delete</button> </td>\n\n      </tr>\n    `;\n}\n\nexport function productsTemplate(products) {\n  return products.map(productTemplate).join('');\n}\n","import { productsTemplate } from './render';\nimport { saveToLS, loadFromLS } from './helpers';\nconst refs = {\n  tableBody: document.querySelector('tbody'),\n};\nconst tableData = loadFromLS('user-data') || [];\n\nfunction init() {\n  const markup = productsTemplate(tableData);\n  refs.tableBody.innerHTML = markup;\n}\n\ninit();\n","import * as XLSX from 'xlsx';\nimport { saveAs } from 'file-saver';\n\nexport function readWorkBook(fileData) {\n  const workbook = XLSX.read(fileData, { type: 'array' });\n  return workbook;\n}\n\nexport function updateCell(workbook, columnName, cellNumber, value) {\n  const worksheet = workbook.Sheets[workbook.SheetNames[0]];\n\n  const cellAddress = columnName + cellNumber;\n\n  if (worksheet[cellAddress]) {\n    worksheet[cellAddress].v = value;\n  } else {\n    createCell(worksheet, cellAddress, value);\n  }\n\n  return workbook;\n}\n\nexport function saveWorkbook(workbook) {\n  const updatedWorkbook = XLSX.write(workbook, {\n    bookType: 'xlsx',\n    type: 'array',\n  });\n\n  const updatedFile = new Blob([updatedWorkbook], {\n    type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\n  });\n\n  saveAs(updatedFile, 'updated.xlsx');\n  console.log('Файл Excel успешно сохранен!');\n}\n\nexport function getFileData(file) {\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader();\n\n    reader.onload = function (event) {\n      const data = new Uint8Array(event.target.result);\n      try {\n        resolve(data);\n      } catch (error) {\n        reject(error);\n      }\n    };\n    reader.readAsArrayBuffer(file);\n  });\n}\n\nfunction createCell(worksheet, cellAddress, value) {\n  let obj;\n  if (typeof value === 'number') {\n    obj = {\n      t: 'n',\n      v: value,\n      w: `${value}`,\n    };\n  } else {\n    obj = {\n      h: `${value}`,\n      r: `<t>${value}</t>`,\n      t: `s`,\n      v: `${value}`,\n      w: `${value}`,\n    };\n  }\n\n  worksheet[cellAddress] = obj;\n}\n\nexport function getCellValue(workbook, cellAddress) {\n  const worksheet = workbook.Sheets[workbook.SheetNames[0]];\n  return worksheet[cellAddress]?.v;\n}\n","import { getCellValue, readWorkBook, getFileData } from './excel';\nimport { v4 as generateID } from 'uuid';\n\nconst START = 5;\nconst COLUMNS = {\n  B: 'product_name',\n  C: 'source',\n  E: 'orders',\n  F: 'popularity',\n  G: 'youtube_media',\n  H: 'reviews',\n  I: 'supplier_link',\n  J: 'supplier_price',\n  K: 'sale_price',\n  L: 'competitor_price',\n  M: 'comments',\n  N: 'margin',\n  O: 'niche',\n  P: 'points',\n};\n\nexport async function loadDataFromFile(file) {\n  const fileData = await getFileData(file);\n  const workBook = readWorkBook(fileData);\n  let counter = 0;\n  const data = [];\n  while (counter < 50) {\n    const product = {};\n\n    for (const [key, value] of Object.entries(COLUMNS)) {\n      const COL = key;\n      const ROW = counter * 3 + START;\n      const cell = COL + ROW;\n      product[value] = getCellValue(workBook, cell);\n    }\n\n    for (let index = 0; index < 3; index++) {\n      product[`link_${index + 1}`] = getCellValue(\n        workBook,\n        `D${counter * 3 + START + index}`\n      );\n    }\n    product.id = generateID();\n    console.log(product);\n    if (!product.product_name) break;\n    data.push(product);\n    counter++;\n  }\n\n  return data;\n}\n","import { readWorkBook, getFileData, saveWorkbook, updateCell } from './excel';\n\nconst START = 5;\n\nexport async function saveDataToExcelFile(file, data) {\n  const fileData = await getFileData(file);\n  let workBook = readWorkBook(fileData);\n\n  data.reduce((workBook, product, i) => {\n    workBook = updateCell(workBook, 'A', i * 3 + START, i + 1);\n\n    for (const [key, value] of Object.entries(COLUMNS)) {\n      workBook = updateCell(workBook, key, i * 3 + START, product[value]);\n    }\n\n    for (let index = 0; index < 3; index++) {\n      workBook = updateCell(\n        workBook,\n        'D',\n        i * 3 + START + index,\n        product[`link_${index + 1}`]\n      );\n    }\n\n    return workBook;\n  }, workBook);\n\n  saveWorkbook(workBook);\n}\n\nconst COLUMNS = {\n  B: 'product_name',\n  C: 'source',\n  E: 'aliexpress',\n  F: 'orders',\n  G: 'popularity',\n  H: 'reviews',\n  I: 'supplier_link',\n  J: 'supplier_price',\n  K: 'sale_price',\n  L: 'competitor_price',\n  M: 'comments',\n  N: 'margin',\n  O: 'niche',\n  P: 'points',\n};\n","import './js/product-list';\nimport { loadDataFromFile } from './js/loadFile';\nimport { saveDataToExcelFile } from './js/saveFile';\nimport { loadFromLS, saveToLS } from './js/helpers';\n\nconst saveForm = document.querySelector('.js-save-form');\n\nsaveForm.addEventListener('submit', onSaveFile);\n\nasync function onSaveFile(e) {\n  e.preventDefault();\n  const fileInput = e.target.elements[0];\n  const file = fileInput.files[0];\n  const data = loadFromLS('user-data') || [];\n\n  if (file) {\n    saveDataToExcelFile(file, data);\n  } else {\n    console.error('Файл не выбран');\n  }\n}\n\nconst loadForm = document.querySelector('.js-load-form');\nloadForm.addEventListener('submit', onLoadFile);\nasync function onLoadFile(e) {\n  e.preventDefault();\n  const fileInput = e.target.elements[0];\n  const file = fileInput.files[0];\n\n  if (file) {\n    const data = await loadDataFromFile(file);\n    saveToLS('user-data', data);\n  } else {\n    console.error('Файл не выбран');\n  }\n}\n"],"names":["productTemplate","product","i","validOrders","validPopularity","validMedia","productsTemplate","products","refs","tableData","loadFromLS","init","markup","readWorkBook","fileData","XLSX.read","updateCell","workbook","columnName","cellNumber","value","worksheet","cellAddress","createCell","saveWorkbook","updatedWorkbook","XLSX.write","updatedFile","saveAs","getFileData","file","resolve","reject","reader","event","data","error","obj","getCellValue","_a","START","COLUMNS","loadDataFromFile","workBook","counter","key","COL","ROW","cell","index","generateID","saveDataToExcelFile","saveForm","onSaveFile","loadForm","onLoadFile","saveToLS"],"mappings":"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"}
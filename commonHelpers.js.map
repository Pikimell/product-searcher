{"version":3,"file":"commonHelpers.js","sources":["../src/js/render.js","../src/js/product-list.js","../src/js/excel.js","../src/js/saveFile.js","../src/main.js"],"sourcesContent":["function productTemplate(product, i) {\n  return `\n      <tr>\n        <td>${i + 1}</td>\n        <td>${product.product_name}</td>\n        <td>${product.source}</td>\n        <td><a href=\"${product.source_link}\">Source Link</a></td>\n        <td>\n        <a href=\"${product.link_1}\">Store-1</a>\n        <a href=\"${product.link_2}\">Store-2</a>\n        <a href=\"${product.link_3}\">Store-3</a>\n        </td>\n        <td><a href=\"${product.aliexpress}\">ALIEXPRESS</a></td>\n        <td class=\"table-border\"></td>\n        <td>${product.orders}</td>\n        <td>${product.popularity}</td>\n        <td>${product.reviews}</td>\n        <td><input type=\"checkbox\" ${\n          product.youtube_media ? 'checked' : ''\n        }></td>\n        <td class=\"table-border\"></td>\n        <td><a href=\"${product.supplier_link}\">Supplier Link</a></td>\n        <td>${product.supplier_price}</td>\n        <td>${product.sale_price}</td>\n        <td>${product.competitor_price}</td>\n        <td>${product.comments}</td>\n        <td>${product.margin}</td>\n        <td>${product.niche}</td>\n        <td>${product.points}</td>\n\n        <td class=\"table-border\"></td>\n\n        <td> <button class=\"btn\" data-type=\"edit\">Edit</button> </td>\n        <td> <button class=\"btn\" data-type=\"delete\">Delete</button> </td>\n\n      </tr>\n    `;\n}\n\nexport function productsTemplate(products) {\n  return products.map(productTemplate).join('');\n}\n","import { productsTemplate } from './render';\nimport { saveToLS, loadFromLS } from './helpers';\nconst refs = {\n  tableBody: document.querySelector('tbody'),\n};\nconst tableData = loadFromLS('user-data') || [];\n\nfunction init() {\n  const markup = productsTemplate(tableData);\n  refs.tableBody.innerHTML = markup;\n}\n\ninit();\n","import * as XLSX from 'xlsx';\nimport { saveAs } from 'file-saver';\n\nexport function readWorkBook(fileData) {\n  const workbook = XLSX.read(fileData, { type: 'array' });\n  return workbook;\n}\n\nexport function updateCell(workbook, columnName, cellNumber, value) {\n  const worksheet = workbook.Sheets[workbook.SheetNames[0]];\n\n  const cellAddress = columnName + cellNumber;\n\n  if (worksheet[cellAddress]) {\n    worksheet[cellAddress].v = value;\n  } else {\n    createCell(worksheet, cellAddress, value);\n  }\n\n  return workbook;\n}\n\nexport function saveWorkbook(workbook) {\n  const updatedWorkbook = XLSX.write(workbook, {\n    bookType: 'xlsx',\n    type: 'array',\n  });\n\n  const updatedFile = new Blob([updatedWorkbook], {\n    type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\n  });\n\n  saveAs(updatedFile, 'updated.xlsx');\n  console.log('Файл Excel успешно сохранен!');\n}\n\nexport function getFileData(file) {\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader();\n\n    reader.onload = function (event) {\n      const data = new Uint8Array(event.target.result);\n      try {\n        resolve(data);\n      } catch (error) {\n        reject(error);\n      }\n    };\n    reader.readAsArrayBuffer(file);\n  });\n}\n\nfunction createCell(worksheet, cellAddress, value) {\n  let obj;\n  if (typeof value === 'number') {\n    obj = {\n      t: 'n',\n      v: value,\n      w: `${value}`,\n    };\n  } else {\n    obj = {\n      h: `${value}`,\n      r: `<t>${value}</t>`,\n      t: `s`,\n      v: `${value}`,\n      w: `${value}`,\n    };\n  }\n\n  worksheet[cellAddress] = obj;\n}\n","import { readWorkBook, getFileData, saveWorkbook, updateCell } from './excel';\n\nconst START = 5;\n// const COLUMNS = 'ABCDEFGHIJKLMNOP';\nexport async function saveDataToExcelFile(file, data) {\n  const fileData = await getFileData(file);\n  let workBook = readWorkBook(fileData);\n\n  data.reduce((workBook, product, i) => {\n    workBook = updateCell(workBook, 'A', i * 3 + START, i + 1);\n\n    for (const [key, value] of Object.entries(COLUMNS)) {\n      workBook = updateCell(workBook, key, i * 3 + START, product[value]);\n    }\n\n    for (let index = 0; index < 3; index++) {\n      workBook = updateCell(\n        workBook,\n        'D',\n        i * 3 + START + index,\n        product[`link_${index + 1}`]\n      );\n    }\n\n    return workBook;\n  }, workBook);\n\n  saveWorkbook(workBook);\n}\n\nconst COLUMNS = {\n  B: 'product_name',\n  C: 'source',\n  E: 'aliexpress',\n  F: 'orders',\n  G: 'popularity',\n  H: 'reviews',\n  I: 'supplier_link',\n  J: 'supplier_price',\n  K: 'sale_price',\n  L: 'competitor_price',\n  M: 'comments',\n  N: 'margin',\n  O: 'niche',\n  P: 'points',\n};\n","import './js/product-list';\nimport { saveDataToExcelFile } from './js/saveFile';\nimport { loadFromLS } from './js/helpers';\n\nconst saveForm = document.querySelector('.js-save-form');\n\nsaveForm.addEventListener('submit', onSaveFile);\n\nasync function onSaveFile(e) {\n  e.preventDefault();\n  const fileInput = e.target.elements[0];\n  const file = fileInput.files[0];\n  const data = loadFromLS('user-data') || [];\n\n  if (file) {\n    saveDataToExcelFile(file, data);\n  } else {\n    console.error('Файл не выбран');\n  }\n}\n"],"names":["productTemplate","product","i","productsTemplate","products","refs","tableData","loadFromLS","init","markup","readWorkBook","fileData","XLSX.read","updateCell","workbook","columnName","cellNumber","value","worksheet","cellAddress","createCell","saveWorkbook","updatedWorkbook","XLSX.write","updatedFile","saveAs","getFileData","file","resolve","reject","reader","event","data","error","obj","START","saveDataToExcelFile","workBook","key","COLUMNS","index","saveForm","onSaveFile"],"mappings":"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"}
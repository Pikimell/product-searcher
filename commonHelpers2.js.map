{"version":3,"file":"commonHelpers2.js","sources":["../src/js/product.js"],"sourcesContent":["import { v4 as generateID } from 'uuid';\nimport { saveToLS, loadFromLS } from './helpers';\nconst userData = loadFromLS('user-data') || [];\nlet id = loadFromLS('editId');\nlet productIndex = null;\n\nconst refs = {\n  form: document.querySelector('.js-product-form'),\n};\n\nfunction init() {\n  window.addEventListener('keydown', onChangeItem);\n  if (!id) {\n    refs.form.addEventListener('submit', onFormSubmit);\n    return;\n  }\n  productIndex = userData.findIndex(el => el.id === id);\n  loadProductData(id);\n  refs.form.elements.btn.textContent = 'Save Changes';\n  refs.form.addEventListener('submit', onFormSave);\n}\n\nfunction loadProductData(id) {\n  refs.form.reset();\n  const product = userData.find(el => el.id === id);\n  if (!product) return;\n  for (const [key, value] of Object.entries(product)) {\n    if (refs.form.elements[key]) refs.form.elements[key].value = value;\n  }\n  refs.form.elements.youtube_media.checked =\n    product.youtube_media === 'Checked';\n\n  setActiveOption(refs.form.elements.source, product.source);\n  setActiveOption(refs.form.elements.niche, product.niche || '');\n}\n\nfunction onFormSubmit(e) {\n  e.preventDefault();\n  const formData = new FormData(e.target);\n  const data = {\n    id: generateID(),\n  };\n\n  formData.forEach((value, key) => {\n    data[key] = value;\n  });\n\n  data.youtube_media = data.youtube_media ? 'Checked' : 'Unchecked';\n  userData.push(data);\n  saveToLS('user-data', userData);\n  e.target.reset();\n}\n\nfunction onFormSave(e) {\n  e.preventDefault();\n  const formData = new FormData(e.target);\n  const productIndex = userData.findIndex(el => el.id === id);\n  const product = { ...userData[productIndex] };\n  delete product.youtube_media;\n\n  formData.forEach((value, key) => {\n    product[key] = value;\n  });\n\n  product.youtube_media = product.youtube_media ? 'Checked' : 'Unchecked';\n  console.log(product.youtube_media);\n\n  userData.splice(productIndex, 1, product);\n  saveToLS('user-data', userData);\n\n  e.target.reset();\n\n  // localStorage.removeItem('editId');\n  // const a = document.createElement('a');\n  // a.href = './index.html';\n  // a.click();\n}\n\ninit();\n\nfunction setActiveOption(selectElement, optionValue) {\n  var options = selectElement.options;\n  for (var i = 0; i < options.length; i++) {\n    if (options[i].value.toLowerCase() === optionValue.toLowerCase()) {\n      options[i].selected = true;\n      break;\n    }\n  }\n}\n\nfunction onChangeItem(e) {\n  if (e.code === 'ArrowRight' || e.code === 'ArrowLeft') {\n    const change = e.code === 'ArrowRight' ? 1 : -1;\n    productIndex += change;\n    if (productIndex < 0 || productIndex > userData.length) {\n      productIndex = 0;\n      return;\n    }\n    id = userData[productIndex].id;\n    loadProductData(id);\n  }\n}\n"],"names":["userData","loadFromLS","id","productIndex","refs","init","onChangeItem","onFormSubmit","el","loadProductData","onFormSave","product","key","value","setActiveOption","formData","data","generateID","saveToLS","selectElement","optionValue","options","i","change"],"mappings":"wGAEA,MAAMA,EAAWC,EAAW,WAAW,GAAK,GAC5C,IAAIC,EAAKD,EAAW,QAAQ,EACxBE,EAAe,KAEnB,MAAMC,EAAO,CACX,KAAM,SAAS,cAAc,kBAAkB,CACjD,EAEA,SAASC,GAAO,CAEd,GADA,OAAO,iBAAiB,UAAWC,CAAY,EAC3C,CAACJ,EAAI,CACPE,EAAK,KAAK,iBAAiB,SAAUG,CAAY,EACjD,MACD,CACDJ,EAAeH,EAAS,UAAUQ,GAAMA,EAAG,KAAON,CAAE,EACpDO,EAAgBP,CAAE,EAClBE,EAAK,KAAK,SAAS,IAAI,YAAc,eACrCA,EAAK,KAAK,iBAAiB,SAAUM,CAAU,CACjD,CAEA,SAASD,EAAgBP,EAAI,CAC3BE,EAAK,KAAK,QACV,MAAMO,EAAUX,EAAS,KAAKQ,GAAMA,EAAG,KAAON,CAAE,EAChD,GAAKS,EACL,UAAW,CAACC,EAAKC,CAAK,IAAK,OAAO,QAAQF,CAAO,EAC3CP,EAAK,KAAK,SAASQ,CAAG,IAAGR,EAAK,KAAK,SAASQ,CAAG,EAAE,MAAQC,GAE/DT,EAAK,KAAK,SAAS,cAAc,QAC/BO,EAAQ,gBAAkB,UAE5BG,EAAgBV,EAAK,KAAK,SAAS,OAAQO,EAAQ,MAAM,EACzDG,EAAgBV,EAAK,KAAK,SAAS,MAAOO,EAAQ,OAAS,EAAE,EAC/D,CAEA,SAASJ,EAAa,EAAG,CACvB,EAAE,eAAc,EAChB,MAAMQ,EAAW,IAAI,SAAS,EAAE,MAAM,EAChCC,EAAO,CACX,GAAIC,EAAY,CACpB,EAEEF,EAAS,QAAQ,CAACF,EAAOD,IAAQ,CAC/BI,EAAKJ,CAAG,EAAIC,CAChB,CAAG,EAEDG,EAAK,cAAgBA,EAAK,cAAgB,UAAY,YACtDhB,EAAS,KAAKgB,CAAI,EAClBE,EAAS,YAAalB,CAAQ,EAC9B,EAAE,OAAO,OACX,CAEA,SAASU,EAAW,EAAG,CACrB,EAAE,eAAc,EAChB,MAAMK,EAAW,IAAI,SAAS,EAAE,MAAM,EAChCZ,EAAeH,EAAS,UAAUQ,GAAMA,EAAG,KAAON,CAAE,EACpDS,EAAU,CAAE,GAAGX,EAASG,CAAY,CAAC,EAC3C,OAAOQ,EAAQ,cAEfI,EAAS,QAAQ,CAACF,EAAOD,IAAQ,CAC/BD,EAAQC,CAAG,EAAIC,CACnB,CAAG,EAEDF,EAAQ,cAAgBA,EAAQ,cAAgB,UAAY,YAC5D,QAAQ,IAAIA,EAAQ,aAAa,EAEjCX,EAAS,OAAOG,EAAc,EAAGQ,CAAO,EACxCO,EAAS,YAAalB,CAAQ,EAE9B,EAAE,OAAO,OAMX,CAEAK,IAEA,SAASS,EAAgBK,EAAeC,EAAa,CAEnD,QADIC,EAAUF,EAAc,QACnBG,EAAI,EAAGA,EAAID,EAAQ,OAAQC,IAClC,GAAID,EAAQC,CAAC,EAAE,MAAM,gBAAkBF,EAAY,cAAe,CAChEC,EAAQC,CAAC,EAAE,SAAW,GACtB,KACD,CAEL,CAEA,SAAShB,EAAa,EAAG,CACvB,GAAI,EAAE,OAAS,cAAgB,EAAE,OAAS,YAAa,CACrD,MAAMiB,EAAS,EAAE,OAAS,aAAe,EAAI,GAE7C,GADApB,GAAgBoB,EACZpB,EAAe,GAAKA,EAAeH,EAAS,OAAQ,CACtDG,EAAe,EACf,MACD,CACDD,EAAKF,EAASG,CAAY,EAAE,GAC5BM,EAAgBP,CAAE,CACnB,CACH"}